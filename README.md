
### Тестовое задание для f. s.
Задача - разработать сервис управления рассылками API администрирования и получения статистики.
### Реализовано
 - Весь основной функционал
 - Подготовлен конфиг `docker-compose.yml` для развертывания контейнеров одной командой
 - Документация к API в `/docs/` (на самом деле она сгенерирована FastAPI на основе описания эндпоинтов и схем Pydantic)
### Технические детали
Технологии: Python/asyncio, FastAPI, PostgreSQL (SQLAlchemy), Docker / docker-compose. На самом деле это новый для меня фреймворк (что вызвало некоторые проблемы и бОльшие затраты времени), но было интересно

При добавлении новой рассылки в `POST /mailings/` запись о рассылке добавляется в базу, затем создается `asyncio.task`, которая при наступлении времени `mailing.start_time` инициализирует рассылку. При инициализации рассылки проверяется состояние рассылки в базе данных - если она была отменена или изменена, она не запустится либо запустится с измененными данными. После проверки рассылки из базы достаются подписчики данной рассылки и складываются в очередь. Инициализируется класс `Mailer`, который достает по одному подписчику из очереди и отправляет ему соответствующее сообщение. Если ответ на запрос имеет любой статус код кроме 200, подписчик попадает в конец очереди для повторного запроса, сообщение получает статус `failed`. Если очередь опустошается или наступает время mailing.end_time, рассылка завершается
### Развертывание
Сервис развернут на http://213.202.238.224:7070/docs

Локальное развертывание в Linux (может меняться в зависимости от ОС):
1. Склонировать репозиторий 
```
git clone https://gitlab.com/descensiontohell/f.s-test-assignment.git && cd f.s-test-assignment
```
2. Скопировать .env файл
```
cp .envexample .env
```
3. Добавить токен и (по желанию) сменить креды  от базы данных
```
vim .env
```
```
AUTH_TOKEN=foobar
```
4. Поднять контейнеры
```
docker-compose up
```
5. Перейти в http://localhost:8080/docs
